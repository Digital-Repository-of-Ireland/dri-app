$(document).ready(function () {
  OpenSeadragon.DEFAULT_SETTINGS.timeout = 60000;
  
  var sources = $('#dri_iiif_view').data('sources');
  var viewer = OpenSeadragon({
      id:                 "dri_iiif_view",
      prefixUrl:          "",
      preserveViewport:   false,
      visibilityRatio:    1,
      sequenceMode: true,
      showNavigator: true,
      showRotationControl: true,
      gestureSettingsTouch: {
          pinchRotate: true
      },
      timeout: 60000,
      navImages:          {
                            zoomIn: {
                              REST:     "<%= image_path('openseadragon/zoomin_rest.png') %>",
                              GROUP:    "<%= image_path('openseadragon/zoomin_grouphover.png') %>",
                              HOVER:    "<%= image_path('openseadragon/zoomin_hover.png') %>",
                              DOWN:     "<%= image_path('openseadragon/zoomin_pressed.png') %>"
                            },
                            zoomOut: {
                                REST:   "<%= image_path('openseadragon/zoomout_rest.png') %>",
                                GROUP:  "<%= image_path('openseadragon/zoomout_grouphover.png') %>",
                                HOVER:  "<%= image_path('openseadragon/zoomout_hover.png') %>",
                                DOWN:   "<%= image_path('openseadragon/zoomout_pressed.png') %>"
                            },
                            home: {
                                REST:   "<%= image_path('openseadragon/home_rest.png') %>",
                                GROUP:  "<%= image_path('openseadragon/home_grouphover.png') %>",
                                HOVER:  "<%= image_path('openseadragon/home_hover.png') %>",
                                DOWN:   "<%= image_path('openseadragon/home_pressed.png') %>"
                            },
                            fullpage: {
                                REST:   "<%= image_path('openseadragon/fullpage_rest.png') %>",
                                GROUP:  "<%= image_path('openseadragon/fullpage_grouphover.png') %>",
                                HOVER:  "<%= image_path('openseadragon/fullpage_hover.png') %>",
                                DOWN:   "<%= image_path('openseadragon/fullpage_pressed.png') %>"
                            },
                            rotateleft: {
                                REST:   "<%= image_path('openseadragon/rotateleft_rest.png') %>",
                                GROUP:  "<%= image_path('openseadragon/rotateleft_grouphover.png') %>",
                                HOVER:  "<%= image_path('openseadragon/rotateleft_hover.png') %>",
                                DOWN:   "<%= image_path('openseadragon/rotateleft_pressed.png') %>"
                            },
                            rotateright: {
                                REST:   "<%= image_path('openseadragon/rotateright_rest.png') %>",
                                GROUP:  "<%= image_path('openseadragon/rotateright_grouphover.png') %>",
                                HOVER:  "<%= image_path('openseadragon/rotateright_hover.png') %>",
                                DOWN:   "<%= image_path('openseadragon/rotateright_pressed.png') %>"
                            },
                            previous: {
                                REST:   "<%= image_path('openseadragon/previous_rest.png') %>",
                                GROUP:  "<%= image_path('openseadragon/previous_grouphover.png') %>",
                                HOVER:  "<%= image_path('openseadragon/previous_hover.png') %>",
                                DOWN:   "<%= image_path('openseadragon/previous_pressed.png') %>"
                            },
                            next: {
                                REST:   "<%= image_path('openseadragon/next_rest.png') %>",
                                GROUP:  "<%= image_path('openseadragon/next_grouphover.png') %>",
                                HOVER:  "<%= image_path('openseadragon/next_hover.png') %>",
                                DOWN:   "<%= image_path('openseadragon/next_pressed.png') %>"
                            }
                          },
      tileSources:        sources
      });

  $('a.dri_iiif').on('click', function() {
    if(viewer != null) {
      viewer.goToPage($('.carousel').find('.active').index());
    }
  });
});
